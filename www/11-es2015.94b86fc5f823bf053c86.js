(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{"3im5":function(t,e,o){"use strict";o.r(e),o.d(e,"AuthorizationsModule",(function(){return G}));var n=o("ofXK"),r=o("tyNb"),i=o("AytR"),s=o("fXoL"),c=o("ryO2"),a=o("TEn/");let b=(()=>{class t{constructor(t){this.userService=t}ngOnInit(){}disconnect(){this.userService.has&&window.localStorage.removeItem(i.a.storage.student)}}return t.\u0275fac=function(e){return new(e||t)(s.Hb(c.a))},t.\u0275cmp=s.Bb({type:t,selectors:[["sost-authorizations"]],decls:14,vars:0,consts:[["slat","bottom"],["tab","login"],["name","home"],["tab","signup"],["name","calendar"],["ngClick","disconnect()"],["name","log-out"]],template:function(t,e){1&t&&(s.Mb(0,"ion-tabs"),s.Mb(1,"ion-tab-bar",0),s.Mb(2,"ion-tab-button",1),s.Ib(3,"ion-icon",2),s.Mb(4,"ion-label"),s.hc(5,"Login"),s.Lb(),s.Lb(),s.Mb(6,"ion-tab-button",3),s.Ib(7,"ion-icon",4),s.Mb(8,"ion-label"),s.hc(9,"Register"),s.Lb(),s.Lb(),s.Mb(10,"ion-tab-button",5),s.Ib(11,"ion-icon",6),s.Mb(12,"ion-label"),s.hc(13,"Disconnect"),s.Lb(),s.Lb(),s.Lb(),s.Lb())},directives:[a.m,a.k,a.l,a.e,a.h],styles:[""]}),t})(),l=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=s.Bb({type:t,selectors:[["sost-toolbar"]],inputs:{title:"title"},decls:4,vars:1,template:function(t,e){1&t&&(s.Mb(0,"ion-header"),s.Mb(1,"ion-toolbar"),s.Mb(2,"ion-title"),s.hc(3),s.Lb(),s.Lb(),s.Lb()),2&t&&(s.xb(3),s.jc(" ",e.title," "))},directives:[a.d,a.p,a.o],styles:[""]}),t})(),u=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=s.Bb({type:t,selectors:[["sost-home"]],decls:10,vars:1,consts:[[3,"title"],["routerLink","/auth/login"],["routerLink","/auth/signup"],["routerLink","/contacts"]],template:function(t,e){1&t&&(s.Ib(0,"sost-toolbar",0),s.Mb(1,"ion-content"),s.Mb(2,"h1"),s.hc(3," CSS in global.scss "),s.Lb(),s.Mb(4,"ion-button",1),s.hc(5,"Login"),s.Lb(),s.Mb(6,"ion-button",2),s.hc(7,"Signup"),s.Lb(),s.Mb(8,"ion-button",3),s.hc(9,"Contacts"),s.Lb(),s.Lb()),2&t&&s.Zb("title","Home")},directives:[l,a.c,a.b,r.h,a.u],styles:[""]}),t})();var p=o("3Pt+");let h=(()=>{class t{constructor(t){this.fb=t}formBuild(){return this.fb.group({email:["",[p.k.required,p.k.email]],password:["",[p.k.required,p.k.maxLength(15)]]})}}return t.\u0275fac=function(e){return new(e||t)(s.Qb(p.a))},t.\u0275prov=s.Db({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var m=o("vkgz"),d=o("tk/3");let g=(()=>{class t{constructor(){}getRegister(){return this.register}setRegister(t){this.register=t}getLogin(){return this.login}setLogin(t){this.login=t}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=s.Db({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),f=(()=>{class t{constructor(t,e,o){this.http=t,this.userService=e,this.loaderService=o}register(t){return this.http.post(i.a.api.signup,{username:t.get("username").value,email:t.get("email").value,password:t.get("password").value}).pipe(Object(m.a)(()=>{this.loaderService.setRegister(!1)}))}login(t){return this.http.post(i.a.api.login,{email:t.get("email").value,password:t.get("password").value}).pipe(Object(m.a)(t=>{this.userService.setActive(t),this.loaderService.setLogin(!1)}))}}return t.\u0275fac=function(e){return new(e||t)(s.Qb(d.b),s.Qb(c.a),s.Qb(g))},t.\u0275prov=s.Db({token:t,factory:t.\u0275fac,providedIn:"any"}),t})();function v(t,e){1&t&&(s.Mb(0,"span"),s.hc(1,"Credentials not found"),s.Lb())}function L(t,e){1&t&&(s.Mb(0,"span"),s.hc(1,"An error occured"),s.Lb())}function w(t,e){if(1&t&&(s.Mb(0,"ion-item"),s.Mb(1,"ion-text",7),s.Kb(2,8),s.fc(3,v,2,0,"span",9),s.fc(4,L,2,0,"span",10),s.Jb(),s.Lb(),s.Lb()),2&t){const t=s.Wb();s.xb(2),s.Zb("ngSwitch",t.error.status),s.xb(1),s.Zb("ngSwitchCase",404)}}function M(t,e){1&t&&(s.Mb(0,"ion-text"),s.hc(1," Doit contenir un E-mail. "),s.Lb())}function x(t,e){1&t&&(s.Mb(0,"ion-text",7),s.hc(1," Le mot de passe saisit est trop court "),s.Lb())}function I(t,e){1&t&&(s.Mb(0,"ion-text"),s.hc(1," Le mot de passe saisit est trop long "),s.Lb())}function S(t,e){if(1&t&&(s.Mb(0,"div"),s.Mb(1,"ion-button",11),s.hc(2,"Submit"),s.Lb(),s.Lb()),2&t){const t=s.Wb();s.xb(1),s.Zb("disabled",!t.loginForm.valid)}}function y(t,e){1&t&&(s.Mb(0,"div"),s.Ib(1,"ion-spinner",12),s.Lb())}let k=(()=>{class t{constructor(t,e,o,n){this.loginService=t,this.httpService=e,this.router=o,this.loaderService=n}ngOnInit(){this.loginForm=this.loginService.formBuild(),alert(i.a.production)}enter(){console.log("ENTER")}login(){this.error=null,this.httpService.login(this.loginForm).subscribe(t=>{console.log("In login.component !")},t=>{this.error=t})}}return t.\u0275fac=function(e){return new(e||t)(s.Hb(h),s.Hb(f),s.Hb(r.g),s.Hb(g))},t.\u0275cmp=s.Bb({type:t,selectors:[["sost-login"]],decls:20,vars:7,consts:[[1,"ion-padding"],[3,"formGroup","ngSubmit"],[4,"ngIf"],["type","email","formControlName","email"],["type","password","formControlName","password"],["color","danger",4,"ngIf"],["routerLink","/auth/home"],["color","danger"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],["type","submit","color","primary",3,"disabled"],["name","crescent"]],template:function(t,e){1&t&&(s.Mb(0,"ion-content",0),s.Mb(1,"h1"),s.hc(2,"Main Content"),s.Lb(),s.Mb(3,"form",1),s.Ub("ngSubmit",(function(){return e.login()})),s.fc(4,w,5,2,"ion-item",2),s.Mb(5,"ion-item"),s.Mb(6,"ion-label"),s.hc(7,"E-mail"),s.Lb(),s.Ib(8,"ion-input",3),s.Lb(),s.fc(9,M,2,0,"ion-text",2),s.Mb(10,"ion-item"),s.Mb(11,"ion-label"),s.hc(12,"Password"),s.Lb(),s.Ib(13,"ion-input",4),s.Lb(),s.fc(14,x,2,0,"ion-text",5),s.fc(15,I,2,0,"ion-text",2),s.fc(16,S,3,1,"div",2),s.fc(17,y,2,0,"div",2),s.Lb(),s.Mb(18,"ion-button",6),s.hc(19,"Home"),s.Lb(),s.Lb()),2&t&&(s.xb(3),s.Zb("formGroup",e.loginForm),s.xb(1),s.Zb("ngIf",null!=e.error),s.xb(5),s.Zb("ngIf",e.loginForm.controls.email.hasError("email")),s.xb(5),s.Zb("ngIf",e.loginForm.controls.password.hasError("minlength")),s.xb(1),s.Zb("ngIf",e.loginForm.controls.password.hasError("maxlength")),s.xb(1),s.Zb("ngIf",!e.loaderService.getLogin()),s.xb(1),s.Zb("ngIf",e.loaderService.getLogin()))},directives:[a.c,p.l,p.i,p.c,n.i,a.g,a.h,a.f,a.v,p.h,p.b,a.b,r.h,a.u,a.n,n.j,n.k,n.l,a.j],styles:[""]}),t})(),Z=(()=>{class t{constructor(){}validate(t){return t.dirty?(this.subscription||(this.subscription=t.root.get("password").valueChanges.subscribe(()=>t.updateValueAndValidity())),console.log("Password : "+t.root.get("password").value),console.log("Password2 : "+t.value),t.root.get("password").value!==t.value?{confirm:!0}:null):(this.subscription&&(this.subscription.unsubscribe(),this.subscription=null),null)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=s.Cb({type:t,selectors:[["","sostRepeatedPassword",""]],features:[s.wb([{provide:p.e,useExisting:t,multi:!0}])]}),t.\u0275prov=s.Db({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),C=(()=>{class t{constructor(t,e){this.fb=t,this.repeatedPasswordValidator=e}formBuild(){return this.fb.group({email:["",[p.k.required,p.k.email]],username:["",[p.k.required,p.k.maxLength(15)]],password:["",[p.k.required,p.k.maxLength(20)]],passwordConf:["",[this.repeatedPasswordValidator]]})}}return t.\u0275fac=function(e){return new(e||t)(s.Qb(p.a),s.Qb(Z))},t.\u0275prov=s.Db({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function E(t,e){if(1&t&&(s.Mb(0,"ion-item"),s.Mb(1,"ion-text",9),s.hc(2),s.Lb(),s.Lb()),2&t){const t=s.Wb();s.xb(2),s.ic(t.error)}}function F(t,e){1&t&&(s.Mb(0,"ion-text"),s.hc(1," Doit contenir un E-mail. "),s.Lb())}function H(t,e){1&t&&(s.Mb(0,"ion-text"),s.hc(1," Le nom d'utilisateur saisie est trop court "),s.Lb())}function P(t,e){1&t&&(s.Mb(0,"ion-text"),s.hc(1," Le nom d'utilisateur saisie est trop long "),s.Lb())}function j(t,e){1&t&&(s.Mb(0,"ion-text"),s.hc(1," Le mot de passe saisit est trop court "),s.Lb())}function D(t,e){1&t&&(s.Mb(0,"ion-text"),s.hc(1," Le mot de passe saisit est trop long "),s.Lb())}function N(t,e){1&t&&(s.Mb(0,"ion-text",9),s.hc(1," Passwords mismatch ! "),s.Lb())}function O(t,e){if(1&t&&(s.Mb(0,"div"),s.Mb(1,"ion-button",10),s.hc(2,"Submit"),s.Lb(),s.Lb()),2&t){const t=s.Wb();s.xb(1),s.Zb("disabled",!t.signupForm.valid)}}function R(t,e){1&t&&(s.Mb(0,"div"),s.Ib(1,"ion-spinner",11),s.Lb())}const B=[{path:"",component:b,children:[{path:"login",component:k},{path:"signup",component:(()=>{class t{constructor(t,e,o,n){this.formService=t,this.httpService=e,this.router=o,this.loaderService=n}ngOnInit(){this.signupForm=this.formService.formBuild()}register(){this.error=null,this.httpService.register(this.signupForm).subscribe(()=>{this.router.navigate(["/auth","login"])},t=>{this.error=t})}}return t.\u0275fac=function(e){return new(e||t)(s.Hb(C),s.Hb(f),s.Hb(r.g),s.Hb(g))},t.\u0275cmp=s.Bb({type:t,selectors:[["sost-signup"]],decls:29,vars:9,consts:[[1,"ion-padding"],[3,"formGroup","ngSubmit"],[4,"ngIf"],["type","email","formControlName","email"],["formControlName","username"],["type","password","formControlName","password"],["type","password","formControlName","passwordConf"],["color","danger",4,"ngIf"],["routerLink","/auth/home"],["color","danger"],["type","submit","color","primary",3,"disabled"],["name","crescent"]],template:function(t,e){1&t&&(s.Mb(0,"ion-content",0),s.Mb(1,"form",1),s.Ub("ngSubmit",(function(){return e.register()})),s.fc(2,E,3,1,"ion-item",2),s.Mb(3,"ion-item"),s.Mb(4,"ion-label"),s.hc(5,"E-mail"),s.Lb(),s.Ib(6,"ion-input",3),s.fc(7,F,2,0,"ion-text",2),s.Lb(),s.Mb(8,"ion-item"),s.Mb(9,"ion-label"),s.hc(10,"Username"),s.Lb(),s.Ib(11,"ion-input",4),s.fc(12,H,2,0,"ion-text",2),s.fc(13,P,2,0,"ion-text",2),s.Lb(),s.Mb(14,"ion-item"),s.Mb(15,"ion-label"),s.hc(16,"Password"),s.Lb(),s.Ib(17,"ion-input",5),s.fc(18,j,2,0,"ion-text",2),s.fc(19,D,2,0,"ion-text",2),s.Lb(),s.Mb(20,"ion-item"),s.Mb(21,"ion-label"),s.hc(22,"Password confirm"),s.Lb(),s.Ib(23,"ion-input",6),s.fc(24,N,2,0,"ion-text",7),s.Lb(),s.fc(25,O,3,1,"div",2),s.fc(26,R,2,0,"div",2),s.Lb(),s.Mb(27,"ion-button",8),s.hc(28,"Home"),s.Lb(),s.Lb()),2&t&&(s.xb(1),s.Zb("formGroup",e.signupForm),s.xb(1),s.Zb("ngIf",!!e.error),s.xb(5),s.Zb("ngIf",e.signupForm.controls.email.hasError("email")),s.xb(5),s.Zb("ngIf",e.signupForm.controls.username.hasError("minlength")),s.xb(1),s.Zb("ngIf",e.signupForm.controls.username.hasError("maxlength")),s.xb(5),s.Zb("ngIf",e.signupForm.controls.password.hasError("minlength")),s.xb(1),s.Zb("ngIf",e.signupForm.controls.password.hasError("maxlength")),s.xb(6),s.Zb("ngIf",!e.loaderService.getRegister()),s.xb(1),s.Zb("ngIf",e.loaderService.getRegister()))},directives:[a.c,p.l,p.i,p.c,n.i,a.g,a.h,a.f,a.v,p.h,p.b,a.b,r.h,a.u,a.n,a.j],styles:[""]}),t})()},{path:"home",component:u},{path:"**",redirectTo:"home"}]}];let Q=(()=>{class t{}return t.\u0275mod=s.Fb({type:t}),t.\u0275inj=s.Eb({factory:function(e){return new(e||t)},imports:[[r.i.forChild(B)],r.i]}),t})();var q=o("PCNd"),A=o("JIr8"),W=o("nYR2");let z=(()=>{class t{constructor(t){this.loaderService=t}intercept(t,e){console.log("Intercepted ! (authorizationsHttpInterceptor)");let o=null;if(i.a.api.login==t.url)o="login";else{if(!i.a.api.signup)return e.handle(t);o="register"}return this.loaderService[o]=!0,e.handle(t).pipe(Object(A.a)(t=>{let e="Network problem";throw 404===t.status?e="Invalid credentials":400===t.status?e=t.error.error:500===t.status&&(e="Unavailable Webservice"),e}),Object(W.a)(()=>{this.loaderService[o]=!1}))}}return t.\u0275fac=function(e){return new(e||t)(s.Qb(g))},t.\u0275prov=s.Db({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),G=(()=>{class t{}return t.\u0275mod=s.Fb({type:t}),t.\u0275inj=s.Eb({factory:function(e){return new(e||t)},providers:[{provide:d.a,useClass:z,multi:!0}],imports:[[n.b,Q,q.a]]}),t})()}}]);